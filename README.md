## Internal Network Penetration Testing ##

<h2> Table of Contents </h2>

* [Scope](#scope)
* [Host Discovery](#host-discovery)
* [Service Discovery And Port Scanning](#service-discovery-and-port-scanning)
* [Vulnerability Scanning](#vulnerability-scanning)
* [Web-Based Attack Surfaces](#web-based-attack-surfaces)
* [Generating Payloads](generating-payloads)




## Scope  
The scope of engagement comprises of an internal network `10.10.10.0/24` and a domain name: [Virtual InfoSec Africa](https://virtualinfosecafrica.com)
## Host Discovery  

Methods for Host Discovery:  


* Using the Nmap tool  
Host discovery using the nmap tool;

1. We can have a list of all the addresses in the above ![Scope](#scope)(https://github.com/daffum3/internal-network-pentesting/blob/main/nmap%20scanlist.png), create a file, filter the results using the grep command, cut using the awk command and save that in it. 1[savingscanlist](scope#)(https://github.com/daffum3/internal-network-pentesting/blob/main/hostfilter1.jpg)
2. We can find out the hosts online in this network by passing to the nmap, the list of the addresses file;!(https://github.com/daffum3/internal-network-pentesting/blob/main/host%20discovery%20with%20nmap.png)
filter the results using the grep command, cut using the awk command and then saving it in another file.![Hosts online scan](scope#)(https://github.com/daffum3/internal-network-pentesting/blob/main/grephostdiscovery.png)

* Using the Aiodnsbrute tool  
The aiodnsbrute tool is used to brute force a domain name and force out its ip address.Demonstration using the domain provided in the [Scope](#scope)  
1. Install aiodnsbrute using the command "pip3 install aiodnsbrute"  
2. Find a list of wordlists of common subdomains  
3. Run aiodnsbrute  
![aiodnsbruteforcing](https://github.com/daffum3/internal-network-pentesting/blob/main/aiodnsbrute.jpg)

## Service Discovery And Port Scanning  
In an internal network, services on devices connected to this network can be differenciated from each other due to their assigned port numbers.  
We scan ports to find out the services they are running.  
(https://github.com/daffum3/internal-network-pentesting/blob/main/Portscanning3.png)

2. Separate the output of the results into their respective protocols  
(https://github.com/daffum3/internal-network-pentesting/blob/main/protocols_operation.png)

3. For each protocol text file created, insert into it, its ip address it runs on using the vim command  
(https://github.com/daffum3/internal-network-pentesting/blob/main/insertion%20of%20ipaddress.png)



## VULNERABILITY SCANNING
  
APACHE HTTP SERVER 2.24.49


| Current Rating |	CVSS|
|----------------|------|
|High	|8.8|

Finding Summary

It was found that there was improper input validation on APACHE HTTP SERVER 2.24.49. Configuration erroe and improper input validation could expose the server to various types of attacks such as injection attacks;which is injecting malicious code into thep program's input which can later be executed by the program

Evidence

The Metasploit Auxiliary Module was used to scan for vulnerabilities on the HTTP server which is shown below: https://github.com/daffum3/internal-network-pentesting/blob/main/vnc1.png

Affected Resources:

10.10.10.2, 10.10.10.30, 10.10.10.45, 10.10.10.55

Recommendations:

* Upgrade Apache: Update to Apache HTTP Server 2.4.51 or later, which contains fixes for these vulnerabilities.
* Secure Aliased Directories: Ensure Alias and AliasMatch directives are correctly configured and protected.
* Apply Require all denied where needed.
* Disable CGI Scripts: If CGI scripts are not required in aliased directories, disable them.
* Review Configurations: Regularly check and audit directory configurations and access controls.
* Implement Rate Limiting: Use modules like mod_evasive to control request rates and mitigate potential DoS attacks.
* Monitor Server Performance: Use monitoring tools to detect and respond to unusual server behavior.

References:

https://www.cve.org/CVERecord?id=CVE-2021-42013

MySQL 5.6.49 Analysis

|Current Rating|	CVSS|
|--------------|--------|
|Medium|	4.3|

Finding Summary

CVE-2020-14672, this vulnerability allows an attacker to force an invalid signature,causing an assertion failure or possible validation.The highest threat to this vulnerability is to confidentiality,integrity as well as system availability which is the CIA triad

Evidence

The Metasploit Auxiliary Module was used to scan for vulnerabilities on the mySql server which is shown below:
https://github.com/daffum3/internal-network-pentesting/blob/main/mysql.png

[Scan for vulnerabilities on MySQL server](https://github.com/daffum3/internal-network-pentesting/blob/main/mysql2.png)

Affected Resources:

10.10.10.5, 10.10.10.40

Recommendations:

* Upgrade MySQL: Upgrade to the latest stable version of MySQL that includes fixes for these vulnerabilities. For MySQL 5.6 users, consider upgrading to a more recent, supported version such as MySQL 5.7.x or 8.0.x, if feasible.
* Check for Patches: Review the MySQL release notes and apply any relevant security patches that address these vulnerabilities. Ensure that your system is patched with all available updates to mitigate the identified issues.
* Regular Backups: Maintain up-to-date backups of your MySQL databases. Ensure that backups are stored securely and can be quickly restored in the event of an attack or failure.


References:

https://www.tenable.com/plugins/nessus/138571

RealVNC 5.3.2 (vnc)

RealVNC 5.3.2 Analysis

|Current Rating	|CVSS|
|---------------|----|
|Critical|	9.8|

Finding Summary

CVE-2015-7354:A vulnerability allowing unauthorized users to bypass authentication, potentially enabling access to the VNC server without valid credentials.

Evidence:

The Metasploit Auxiliary Module was used to scan for vulnerabilities on the realvnc server which is shown below:
https://github.com/daffum3/internal-network-pentesting/blob/main/vnc1.png

[Scanning VNC module](https://github.com/daffum3/internal-network-pentesting/blob/main/vnc2.png)

## WEB BASED ATTACK SURFACES 

[Eyewitness](https://github.com/daffum3/internal-network-pentesting/blob/main/eyewitness.png)

[Generating java payload](https://github.com/daffum3/internal-network-pentesting/blob/main/Java%20server2.png)

[Generating python payload](https://github.com/daffum3/internal-network-pentesting/blob/main/python%20server2.png)


## SUMMARY OF FINDING
| FINDING                   | SEVERITY                |  
|---------------------------|-------------------------|  
|  Weak login credentials of the MySQL server| High   |  
|    Allowed access to unauthorized users by bypassing authentication on the VNC server                      |  Critical                       |  
| Misconfigurations on server making it vulnerable to injection attacks| High                               |   
 
CVSS v3.0 Reference Table  
 
|Qualitative Rating|CVSS Score|  
|------------------|----------|  
| None/Informational|N/A      |    
|Low               |0.1 – 3.9 |  
|Medium            |4.0 – 6.9 |  
|High              |7.0 – 8.9 |  
|Critical          |9.0 – 10.0|  

## Table 1 : Common Vulnerability Scoring System Version 3.0 
